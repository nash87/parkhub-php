import{r as t,p as q,u as be,w as S,j as e,m as x,Q as X,S as te,T as ye,J as K,U as ee,V as je,O as W,A as B,c as ve,n as ae,z as Z,W as we}from"./index-dlybMJW5.js";import{p as ke}from"./Airplane.es-DCePgZZg.js";import{s as Ne}from"./CaretLeft.es-BnjVtbVl.js";const Ve=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,52H180V44a28,28,0,0,0-28-28H104A28,28,0,0,0,76,44v8H40A20,20,0,0,0,20,72V200a20,20,0,0,0,20,20H216a20,20,0,0,0,20-20V72A20,20,0,0,0,216,52ZM100,44a4,4,0,0,1,4-4h48a4,4,0,0,1,4,4v8H100ZM212,196H44V76H212Zm-48-60a12,12,0,0,1-12,12H140v12a12,12,0,0,1-24,0V148H104a12,12,0,0,1,0-24h12V112a12,12,0,0,1,24,0v12h12A12,12,0,0,1,164,136Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,72V200a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V72a8,8,0,0,1,8-8H216A8,8,0,0,1,224,72Z",opacity:"0.2"}),t.createElement("path",{d:"M216,56H176V48a24,24,0,0,0-24-24H104A24,24,0,0,0,80,48v8H40A16,16,0,0,0,24,72V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V72A16,16,0,0,0,216,56ZM96,48a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM216,200H40V72H216V200Zm-56-64a8,8,0,0,1-8,8H136v16a8,8,0,0,1-16,0V144H104a8,8,0,0,1,0-16h16V112a8,8,0,0,1,16,0v16h16A8,8,0,0,1,160,136Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,56H176V48a24,24,0,0,0-24-24H104A24,24,0,0,0,80,48v8H40A16,16,0,0,0,24,72V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V72A16,16,0,0,0,216,56Zm-64,88H136v16a8,8,0,0,1-16,0V144H104a8,8,0,0,1,0-16h16V112a8,8,0,0,1,16,0v16h16a8,8,0,0,1,0,16Zm8-88H96V48a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,58H174V48a22,22,0,0,0-22-22H104A22,22,0,0,0,82,48V58H40A14,14,0,0,0,26,72V200a14,14,0,0,0,14,14H216a14,14,0,0,0,14-14V72A14,14,0,0,0,216,58ZM94,48a10,10,0,0,1,10-10h48a10,10,0,0,1,10,10V58H94ZM218,200a2,2,0,0,1-2,2H40a2,2,0,0,1-2-2V72a2,2,0,0,1,2-2H216a2,2,0,0,1,2,2Zm-60-64a6,6,0,0,1-6,6H134v18a6,6,0,0,1-12,0V142H104a6,6,0,0,1,0-12h18V112a6,6,0,0,1,12,0v18h18A6,6,0,0,1,158,136Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,56H176V48a24,24,0,0,0-24-24H104A24,24,0,0,0,80,48v8H40A16,16,0,0,0,24,72V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V72A16,16,0,0,0,216,56ZM96,48a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96ZM216,200H40V72H216V200Zm-56-64a8,8,0,0,1-8,8H136v16a8,8,0,0,1-16,0V144H104a8,8,0,0,1,0-16h16V112a8,8,0,0,1,16,0v16h16A8,8,0,0,1,160,136Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,60H172V48a20,20,0,0,0-20-20H104A20,20,0,0,0,84,48V60H40A12,12,0,0,0,28,72V200a12,12,0,0,0,12,12H216a12,12,0,0,0,12-12V72A12,12,0,0,0,216,60ZM92,48a12,12,0,0,1,12-12h48a12,12,0,0,1,12,12V60H92ZM220,200a4,4,0,0,1-4,4H40a4,4,0,0,1-4-4V72a4,4,0,0,1,4-4H216a4,4,0,0,1,4,4Zm-64-64a4,4,0,0,1-4,4H132v20a4,4,0,0,1-8,0V140H104a4,4,0,0,1,0-8h20V112a4,4,0,0,1,8,0v20h20A4,4,0,0,1,156,136Z"}))]]),He=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H156.69a19.86,19.86,0,0,0,14.14-5.86l51.31-51.31A19.86,19.86,0,0,0,228,156.69V48A20,20,0,0,0,208,28ZM52,52H204v92H156a12,12,0,0,0-12,12v48H52ZM168,191V168h23Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,160l-56,56V160Z",opacity:"0.2"}),t.createElement("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H156.69A15.86,15.86,0,0,0,168,219.31L219.31,168A15.86,15.86,0,0,0,224,156.69V48A16,16,0,0,0,208,32ZM48,48H208V152H160a8,8,0,0,0-8,8v48H48ZM196.69,168,168,196.69V168Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H156.69A15.86,15.86,0,0,0,168,219.31L219.31,168A15.86,15.86,0,0,0,224,156.69V48A16,16,0,0,0,208,32ZM160,204.69V160h44.69Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,34H48A14,14,0,0,0,34,48V208a14,14,0,0,0,14,14H156.69a13.94,13.94,0,0,0,9.9-4.1l51.31-51.31a13.94,13.94,0,0,0,4.1-9.9V48A14,14,0,0,0,208,34ZM46,208V48a2,2,0,0,1,2-2H208a2,2,0,0,1,2,2V154H160a6,6,0,0,0-6,6v50H48A2,2,0,0,1,46,208Zm120-6.49V166h35.52Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H156.69A15.86,15.86,0,0,0,168,219.31L219.31,168A15.86,15.86,0,0,0,224,156.69V48A16,16,0,0,0,208,32ZM48,48H208V152H160a8,8,0,0,0-8,8v48H48ZM196.69,168,168,196.69V168Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M208,36H48A12,12,0,0,0,36,48V208a12,12,0,0,0,12,12H156.69a11.93,11.93,0,0,0,8.48-3.51l51.32-51.32a11.93,11.93,0,0,0,3.51-8.48V48A12,12,0,0,0,208,36ZM44,208V48a4,4,0,0,1,4-4H208a4,4,0,0,1,4,4V156H160a4,4,0,0,0-4,4v52H48A4,4,0,0,1,44,208Zm120-1.66V164h42.35Z"}))]]),De=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M228,144v64a12,12,0,0,1-12,12H40a12,12,0,0,1-12-12V144a12,12,0,0,1,24,0v52H204V144a12,12,0,0,1,24,0ZM96.49,80.49,116,61v83a12,12,0,0,0,24,0V61l19.51,19.52a12,12,0,1,0,17-17l-40-40a12,12,0,0,0-17,0l-40,40a12,12,0,1,0,17,17Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M216,48V208H40V48A16,16,0,0,1,56,32H200A16,16,0,0,1,216,48Z",opacity:"0.2"}),t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0ZM93.66,77.66,120,51.31V144a8,8,0,0,0,16,0V51.31l26.34,26.35a8,8,0,0,0,11.32-11.32l-40-40a8,8,0,0,0-11.32,0l-40,40A8,8,0,0,0,93.66,77.66Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0ZM88,80h32v64a8,8,0,0,0,16,0V80h32a8,8,0,0,0,5.66-13.66l-40-40a8,8,0,0,0-11.32,0l-40,40A8,8,0,0,0,88,80Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M222,144v64a6,6,0,0,1-6,6H40a6,6,0,0,1-6-6V144a6,6,0,0,1,12,0v58H210V144a6,6,0,0,1,12,0ZM92.24,76.24,122,46.49V144a6,6,0,0,0,12,0V46.49l29.76,29.75a6,6,0,0,0,8.48-8.48l-40-40a6,6,0,0,0-8.48,0l-40,40a6,6,0,0,0,8.48,8.48Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0ZM93.66,77.66,120,51.31V144a8,8,0,0,0,16,0V51.31l26.34,26.35a8,8,0,0,0,11.32-11.32l-40-40a8,8,0,0,0-11.32,0l-40,40A8,8,0,0,0,93.66,77.66Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M220,144v64a4,4,0,0,1-4,4H40a4,4,0,0,1-4-4V144a4,4,0,0,1,8,0v60H212V144a4,4,0,0,1,8,0ZM90.83,74.83,124,41.66V144a4,4,0,0,0,8,0V41.66l33.17,33.17a4,4,0,1,0,5.66-5.66l-40-40a4,4,0,0,0-5.66,0l-40,40a4,4,0,0,0,5.66,5.66Z"}))]]),se=t.forwardRef((s,i)=>t.createElement(q,{ref:i,...s,weights:Ve}));se.displayName="FirstAidKitIcon";const Me=se,re=t.forwardRef((s,i)=>t.createElement(q,{ref:i,...s,weights:He}));re.displayName="NoteBlankIcon";const Ae=re,ne=t.forwardRef((s,i)=>t.createElement(q,{ref:i,...s,weights:De}));ne.displayName="UploadSimpleIcon";const ie=ne,f={homeoffice:{icon:K,color:"text-primary-600 dark:text-primary-400",bgLight:"bg-primary-100 dark:bg-primary-900/30",bgDark:"bg-primary-200 dark:bg-primary-800/50",ring:"ring-primary-400",dot:"bg-primary-500",emoji:"ðŸ "},vacation:{icon:ke,color:"text-orange-600 dark:text-orange-400",bgLight:"bg-orange-100 dark:bg-orange-900/30",bgDark:"bg-orange-200 dark:bg-orange-800/50",ring:"ring-orange-400",dot:"bg-orange-500",emoji:"ðŸ–ï¸"},sick:{icon:Me,color:"text-red-600 dark:text-red-400",bgLight:"bg-red-100 dark:bg-red-900/30",bgDark:"bg-red-200 dark:bg-red-800/50",ring:"ring-red-400",dot:"bg-red-500",emoji:"ðŸ¤’"},business_trip:{icon:ye,color:"text-purple-600 dark:text-purple-400",bgLight:"bg-purple-100 dark:bg-purple-900/30",bgDark:"bg-purple-200 dark:bg-purple-800/50",ring:"ring-purple-400",dot:"bg-purple-500",emoji:"âœˆï¸"},other:{icon:Ae,color:"text-gray-600 dark:text-gray-400",bgLight:"bg-gray-100 dark:bg-gray-900/30",bgDark:"bg-gray-200 dark:bg-gray-800/50",ring:"ring-gray-400",dot:"bg-gray-500",emoji:"ðŸ“‹"}};function Ee(s,i){return s.getFullYear()===i.getFullYear()&&s.getMonth()===i.getMonth()&&s.getDate()===i.getDate()}function z(s,i,l){const y=s.toISOString().slice(0,10);return y>=i&&y<=l}function le(s){const i=s.getDay(),l=s.getDate()-i+(i===0?-6:1);return new Date(s.getFullYear(),s.getMonth(),l)}function U(s){return s.toISOString().slice(0,10)}function Ie(){const{t:s}=be(),[i,l]=t.useState([]),[y,b]=t.useState([]),[h,c]=t.useState([]),[d,m]=t.useState(!0),[D,M]=t.useState("calendar"),[O,_]=t.useState(!1),[A,P]=t.useState(!1),[C,R]=t.useState(!1),o=t.useMemo(()=>new Date,[]),[j,w]=t.useState(o.getMonth()),[$,T]=t.useState(o.getFullYear()),G=t.useCallback(async()=>{try{const[a,r,n]=await Promise.all([S.listAbsences(),S.teamAbsences(),S.getAbsencePattern()]);a.success&&a.data&&l(a.data),r.success&&r.data&&b(r.data),n.success&&n.data&&c(n.data)}catch{}m(!1)},[]);t.useEffect(()=>{const a=setTimeout(()=>{G()},0);return()=>clearTimeout(a)},[G]);function ce(){j===0?(w(11),T(a=>a-1)):w(a=>a-1)}function oe(){j===11?(w(0),T(a=>a+1)):w(a=>a+1)}const de=t.useCallback((a,r)=>{r.offset.x>80?j===0?(w(11),T(n=>n-1)):w(n=>n-1):r.offset.x<-80&&(j===11?(w(0),T(n=>n+1)):w(n=>n+1))},[j]),k=t.useMemo(()=>h.find(a=>a.absence_type==="homeoffice"),[h]),F=U(o),N=t.useMemo(()=>{const a=i.find(n=>z(o,n.start_date,n.end_date));if(a)return a.absence_type;const r=o.getDay()===0?6:o.getDay()-1;return k&&k.weekdays.includes(r)?"homeoffice":null},[i,k,o]),V=t.useMemo(()=>{const a=le(o),r={homeoffice:0,vacation:0,sick:0,business_trip:0,other:0};for(let n=0;n<5;n++){const g=new Date(a);g.setDate(a.getDate()+n);const p=i.find(u=>z(g,u.start_date,u.end_date));if(p){r[p.absence_type]++;continue}const v=g.getDay()===0?6:g.getDay()-1;k&&k.weekdays.includes(v)&&r.homeoffice++}return r},[i,k,o]),I=t.useMemo(()=>i.filter(r=>r.end_date>=F).sort((r,n)=>r.start_date.localeCompare(n.start_date))[0]||null,[i,F]),me=[s("homeoffice.weekdaysShort.mon"),s("homeoffice.weekdaysShort.tue"),s("homeoffice.weekdaysShort.wed"),s("homeoffice.weekdaysShort.thu"),s("homeoffice.weekdaysShort.fri"),s("homeoffice.weekdaysShort.sat"),s("homeoffice.weekdaysShort.sun")],he=t.useMemo(()=>{const a=$,r=j,n=new Date(a,r,1),g=new Date(a,r+1,0),p=n.getDay()===0?6:n.getDay()-1,v=[];for(let u=0;u<p;u++){const H=new Date(a,r,1-p+u);v.push({date:H,inMonth:!1,isToday:!1,absenceTypes:[]})}for(let u=1;u<=g.getDate();u++){const H=new Date(a,r,u),J=H.getDay()===0?6:H.getDay()-1,L=[];for(const Y of i)if(z(H,Y.start_date,Y.end_date)){const Q=Y.absence_type;L.includes(Q)||L.push(Q)}J<5&&k&&k.weekdays.includes(J)&&!L.includes("homeoffice")&&L.push("homeoffice"),v.push({date:H,inMonth:!0,isToday:Ee(H,o),absenceTypes:L})}for(;v.length%7!==0;){const u=new Date(a,r+1,v.length-p-g.getDate()+1);v.push({date:u,inMonth:!1,isToday:!1,absenceTypes:[]})}return v},[i,k,j,$,o]),xe=new Date($,j,1).toLocaleDateString(void 0,{month:"long",year:"numeric"});async function ge(a){(await S.deleteAbsence(a)).success&&(l(n=>n.filter(g=>g.id!==a)),Z.success(s("absences.deleted")))}async function pe(a,r,n,g){const p=await S.createAbsence(a,r,n,g||void 0);p.success&&p.data?(l(v=>[...v,p.data].sort((u,H)=>u.start_date.localeCompare(H.start_date))),Z.success(s("absences.added")),_(!1)):Z.error(p.error?.message||"Error")}async function fe(a){const r=await S.setAbsencePattern("homeoffice",a);r.success&&r.data&&(c(n=>[...n.filter(p=>p.absence_type!=="homeoffice"),r.data]),Z.success(s("absences.patternUpdated")))}const ue={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.06}}},E={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return d?e.jsxs("div",{className:"space-y-6 max-w-full overflow-x-hidden",children:[e.jsx("div",{className:"h-8 w-64 skeleton rounded-lg"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(a=>e.jsx("div",{className:"h-24 skeleton rounded-2xl"},a))}),e.jsx("div",{className:"h-80 skeleton rounded-2xl"})]}):e.jsxs(x.div,{variants:ue,initial:"hidden",animate:"show",className:"space-y-6 max-w-full overflow-x-hidden",children:[e.jsxs(x.div,{variants:E,className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(X,{weight:"fill",className:"w-7 h-7 text-primary-600"}),s("absences.title")]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:s("absences.subtitle")})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-800 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>M("calendar"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${D==="calendar"?"bg-white dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:s("absences.myCalendar")}),e.jsxs("button",{onClick:()=>M("team"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${D==="team"?"bg-white dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"}`,children:[e.jsx(te,{weight:"bold",className:"w-4 h-4 inline mr-1"}),s("absences.teamView")]})]})})]}),N&&e.jsx(x.div,{variants:E,className:`card ${f[N].bgLight} border ${N==="homeoffice"?"border-primary-200 dark:border-primary-800":N==="vacation"?"border-orange-200 dark:border-orange-800":N==="sick"?"border-red-200 dark:border-red-800":N==="business_trip"?"border-purple-200 dark:border-purple-800":"border-gray-200 dark:border-gray-800"} p-4`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[(()=>{const a=f[N].icon;return e.jsx(a,{weight:"fill",className:`w-6 h-6 ${f[N].color}`})})(),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:s(`absences.todayBanner.${N}`)}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s("absences.todayBannerDesc")})]})]})}),e.jsxs(x.div,{variants:E,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("absences.thisWeek")}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[V.homeoffice>0&&e.jsxs("span",{className:"text-sm font-semibold text-primary-600 dark:text-primary-400",children:[V.homeoffice,"Ã— ",f.homeoffice.emoji]}),V.vacation>0&&e.jsxs("span",{className:"text-sm font-semibold text-orange-600 dark:text-orange-400",children:[V.vacation,"Ã— ",f.vacation.emoji]}),V.sick>0&&e.jsxs("span",{className:"text-sm font-semibold text-red-600 dark:text-red-400",children:[V.sick,"Ã— ",f.sick.emoji]}),V.business_trip>0&&e.jsxs("span",{className:"text-sm font-semibold text-purple-600 dark:text-purple-400",children:[V.business_trip,"Ã— ",f.business_trip.emoji]}),Object.values(V).every(a=>a===0)&&e.jsx("span",{className:"text-sm text-gray-400",children:s("absences.noAbsencesThisWeek")})]})]}),e.jsx("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center",children:e.jsx(X,{weight:"fill",className:"w-5 h-5 text-primary-600 dark:text-primary-400"})})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("absences.nextAbsence")}),I?e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:new Date(I.start_date+"T00:00:00").toLocaleDateString(void 0,{day:"numeric",month:"short"})}),e.jsxs("span",{className:`ml-2 text-sm ${f[I.absence_type]?.color||""}`,children:[f[I.absence_type]?.emoji," ",s(`absences.types.${I.absence_type}`)]})]}):e.jsx("p",{className:"mt-2 text-sm text-gray-400",children:s("absences.noneScheduled")})]}),e.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900/30 rounded-xl flex items-center justify-center",children:e.jsx(ee,{weight:"fill",className:"w-5 h-5 text-orange-600 dark:text-orange-400"})})]})}),e.jsx("div",{className:"stat-card sm:col-span-2 lg:col-span-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("absences.totalEntries")}),e.jsxs("div",{className:"mt-2 flex items-baseline gap-2",children:[e.jsx("span",{className:"stat-value text-primary-600 dark:text-primary-400",children:i.length}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("absences.entries")})]})]}),e.jsx("div",{className:"w-10 h-10 bg-emerald-100 dark:bg-emerald-900/30 rounded-xl flex items-center justify-center",children:e.jsx(je,{weight:"fill",className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"})})]})})]}),D==="calendar"?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[e.jsxs(x.div,{variants:E,className:"lg:col-span-3 card p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:xe}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:ce,className:"btn btn-ghost btn-icon min-w-[44px] min-h-[44px]","aria-label":"Previous month",children:e.jsx(Ne,{weight:"bold",className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{w(o.getMonth()),T(o.getFullYear())},className:"btn btn-ghost text-xs px-2",children:s("absences.today")}),e.jsx("button",{onClick:oe,className:"btn btn-ghost btn-icon min-w-[44px] min-h-[44px]","aria-label":"Next month",children:e.jsx(W,{weight:"bold",className:"w-5 h-5"})})]})]}),e.jsx(x.div,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.2,onDragEnd:de,className:"touch-pan-y",children:e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[me.map(a=>e.jsx("div",{className:"text-center text-xs font-semibold text-gray-400 dark:text-gray-500 py-2",children:a},a)),he.map((a,r)=>{const n=a.date.getDay()===0||a.date.getDay()===6,g=a.absenceTypes[0],p=g?f[g]:null;return e.jsxs("div",{className:`relative flex flex-col items-center justify-center rounded-lg text-sm font-medium transition-all min-h-[40px] min-w-[40px] ${a.inMonth?a.isToday?"ring-2 ring-primary-500 ring-offset-1 dark:ring-offset-gray-900":"":"text-gray-300 dark:text-gray-700"} ${p?`${p.bgDark} ${p.color.split(" ")[0]}`:n&&a.inMonth?"text-gray-400 dark:text-gray-500":a.inMonth?"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800":""}`,children:[a.date.getDate(),a.absenceTypes.length>0&&e.jsx("div",{className:"flex gap-0.5 mt-0.5",children:a.absenceTypes.slice(0,3).map((v,u)=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${f[v].dot}`},u))})]},r)})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-4 pt-4 border-t border-gray-100 dark:border-gray-800 text-xs text-gray-500 dark:text-gray-400",children:[Object.entries(f).map(([a,r])=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-3 h-3 rounded-sm ${r.bgDark}`}),e.jsx("span",{children:s(`absences.types.${a}`)})]},a)),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm ring-2 ring-primary-500"}),e.jsx("span",{children:s("absences.legendToday")})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(x.div,{variants:E,className:"card p-4 sm:p-6",children:[e.jsxs("button",{onClick:()=>R(!C),className:"flex items-center justify-between w-full text-left",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(K,{weight:"fill",className:"w-5 h-5 text-primary-600"}),s("absences.weeklyPattern")]}),e.jsx(W,{weight:"bold",className:`w-4 h-4 text-gray-400 transition-transform ${C?"rotate-90":""}`})]}),e.jsx(B,{children:C&&e.jsxs(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-3 mb-3",children:s("absences.patternDesc")}),e.jsx(Se,{weekdays:k?.weekdays||[],onChange:fe,t:s})]})})]}),e.jsxs(x.div,{variants:E,className:"card p-4 sm:p-6",children:[e.jsxs("button",{onClick:()=>P(!A),className:"flex items-center justify-between w-full text-left",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ie,{weight:"bold",className:"w-5 h-5 text-orange-600"}),s("absences.importIcal")]}),e.jsx(W,{weight:"bold",className:`w-4 h-4 text-gray-400 transition-transform ${A?"rotate-90":""}`})]}),e.jsx(B,{children:A&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx(Ze,{t:s,onImported:a=>{l(r=>[...r,...a].sort((n,g)=>n.start_date.localeCompare(g.start_date)))}})})})]}),e.jsxs(x.div,{variants:E,className:"card p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx(ee,{weight:"fill",className:"w-5 h-5 text-emerald-600"}),s("absences.upcoming")]}),e.jsxs("div",{className:"space-y-2 max-h-72 overflow-y-auto",children:[i.filter(a=>a.end_date>=F).sort((a,r)=>a.start_date.localeCompare(r.start_date)).map(a=>{const r=f[a.absence_type]||f.other,n=r.icon;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(n,{weight:"fill",className:`w-5 h-5 flex-shrink-0 ${r.color}`}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white block truncate",children:[new Date(a.start_date+"T00:00:00").toLocaleDateString(void 0,{day:"numeric",month:"short"}),a.start_date!==a.end_date&&e.jsxs(e.Fragment,{children:[" â€“ ",new Date(a.end_date+"T00:00:00").toLocaleDateString(void 0,{day:"numeric",month:"short"})]})]}),e.jsx("span",{className:`text-xs ${r.color}`,children:s(`absences.types.${a.absence_type}`)}),a.note&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:a.note})]})]}),e.jsx("button",{onClick:()=>ge(a.id),className:"btn btn-ghost btn-icon text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 min-w-[44px] min-h-[44px]",children:e.jsx(ve,{weight:"bold",className:"w-4 h-4"})})]},a.id)}),i.filter(a=>a.end_date>=F).length===0&&e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 text-center py-6",children:s("absences.noEntries")})]})]})]})]}):e.jsx($e,{teamEntries:y,todayStr:F,t:s}),e.jsx(x.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>_(!0),className:"fixed bottom-20 right-4 md:bottom-8 md:right-8 z-20 w-14 h-14 bg-primary-600 hover:bg-primary-700 text-white rounded-full shadow-lg flex items-center justify-center",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:e.jsx(ae,{weight:"bold",className:"w-6 h-6"})}),e.jsx(B,{children:O&&e.jsx(_e,{onClose:()=>_(!1),onAdd:pe,t:s})})]})}function Se({weekdays:s,onChange:i,t:l}){const y=[l("homeoffice.weekdaysShort.mon"),l("homeoffice.weekdaysShort.tue"),l("homeoffice.weekdaysShort.wed"),l("homeoffice.weekdaysShort.thu"),l("homeoffice.weekdaysShort.fri")];function b(h){const c=s.includes(h)?s.filter(d=>d!==h):[...s,h].sort();i(c)}return e.jsx("div",{className:"grid grid-cols-5 gap-2",children:y.map((h,c)=>{const d=s.includes(c);return e.jsxs(x.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>b(c),className:`flex flex-col items-center gap-1 py-3 px-2 rounded-xl border-2 transition-all font-medium min-h-[44px] ${d?"bg-primary-100 dark:bg-primary-900/40 border-primary-400 dark:border-primary-600 text-primary-700 dark:text-primary-300":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("span",{className:"text-sm",children:h}),d&&e.jsx(K,{weight:"fill",className:"w-4 h-4"})]},c)})})}function Ze({t:s,onImported:i}){const l=t.useRef(null),[y,b]=t.useState(!1);async function h(d){try{const m=await S.importAbsenceIcal(d);m.success&&m.data?(i(m.data),Z.success(s("absences.imported",{count:m.data.length}))):Z.error(m.error?.message||"Import failed")}catch{Z.error("Import failed")}}function c(d){d.preventDefault(),b(!1);const m=d.dataTransfer.files[0];m&&h(m)}return e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:s("absences.importDesc")}),e.jsxs("div",{onDragOver:d=>{d.preventDefault(),b(!0)},onDragLeave:()=>b(!1),onDrop:c,onClick:()=>l.current?.click(),className:`border-2 border-dashed rounded-xl p-6 text-center cursor-pointer transition-colors min-h-[44px] ${y?"border-primary-400 bg-primary-50 dark:bg-primary-900/20":"border-gray-300 dark:border-gray-700 hover:border-gray-400"}`,children:[e.jsx(ie,{weight:"bold",className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("absences.importDropzone")})]}),e.jsx("input",{ref:l,type:"file",accept:".ics,.ical",onChange:d=>{const m=d.target.files?.[0];m&&h(m),l.current&&(l.current.value="")},className:"hidden"})]})}function _e({onClose:s,onAdd:i,t:l}){const[y,b]=t.useState("homeoffice"),[h,c]=t.useState(""),[d,m]=t.useState(""),[D,M]=t.useState(""),O=t.useMemo(()=>new Date,[]),_=O.toISOString().slice(0,10),A=le(O),P=new Date(A);P.setDate(A.getDate()+4);function C(){c(_),m(_)}function R(){c(U(A)),m(U(P))}return e.jsxs(e.Fragment,{children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/40 z-50",onClick:s}),e.jsxs(x.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-gray-900 rounded-t-2xl max-h-[90vh] overflow-y-auto sm:relative sm:max-w-lg sm:mx-auto sm:my-auto sm:rounded-2xl sm:fixed sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:bottom-auto",style:{paddingBottom:"env(safe-area-inset-bottom, 16px)"},children:[e.jsx("div",{className:"w-8 h-1 bg-gray-300 dark:bg-gray-700 rounded-full mx-auto mt-3 sm:hidden"}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:l("absences.addAbsence")}),e.jsx("button",{onClick:s,className:"btn btn-ghost btn-icon min-w-[44px] min-h-[44px]",children:e.jsx(we,{weight:"bold",className:"w-5 h-5"})})]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2 mb-4",children:Object.entries(f).map(([o,j])=>{const w=j.icon,$=y===o;return e.jsxs(x.button,{whileTap:{scale:.95},onClick:()=>b(o),className:`flex flex-col items-center gap-1 py-3 px-2 rounded-xl border-2 transition-all min-h-[44px] ${$?`${j.bgLight} border-current ${j.color}`:"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-500"}`,children:[e.jsx(w,{weight:$?"fill":"regular",className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium truncate w-full text-center",children:l(`absences.types.${o}`)})]},o)})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:C,className:"btn btn-ghost text-sm flex-1 min-h-[44px]",children:l("absences.quickToday")}),e.jsx("button",{onClick:R,className:"btn btn-ghost text-sm flex-1 min-h-[44px]",children:l("absences.quickWeek")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 block",children:l("absences.startDate")}),e.jsx("input",{type:"date",value:h,onChange:o=>{c(o.target.value),(!d||o.target.value>d)&&m(o.target.value)},className:"input w-full text-[16px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 block",children:l("absences.endDate")}),e.jsx("input",{type:"date",value:d,onChange:o=>m(o.target.value),className:"input w-full text-[16px]",min:h})]})]}),e.jsx("input",{type:"text",placeholder:l("absences.notePlaceholder"),value:D,onChange:o=>M(o.target.value),className:"input w-full mb-4 text-[16px]"}),e.jsxs("button",{onClick:()=>i(y,h,d,D),disabled:!h||!d,className:"btn btn-primary w-full min-h-[44px]",children:[e.jsx(ae,{weight:"bold",className:"w-4 h-4"}),l("absences.addBtn")]})]})]})]})}function $e({teamEntries:s,todayStr:i,t:l}){const y=s.filter(c=>c.end_date>=i).sort((c,d)=>c.start_date.localeCompare(d.start_date)),b={};for(const c of y)b[c.user_name]||(b[c.user_name]=[]),b[c.user_name].push(c);const h={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return e.jsx(x.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},initial:"hidden",animate:"show",className:"space-y-4",children:Object.keys(b).length===0?e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(te,{weight:"light",className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:l("absences.noTeamEntries")})]}):Object.entries(b).map(([c,d])=>e.jsxs(x.div,{variants:h,className:"card p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-full flex items-center justify-center text-sm font-bold text-primary-700 dark:text-primary-300",children:c.charAt(0).toUpperCase()}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:c})]}),e.jsx("div",{className:"space-y-2",children:d.map((m,D)=>{const M=f[m.absence_type]||f.other;return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${M.bgLight}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${M.dot}`}),e.jsx("span",{className:`text-sm font-medium ${M.color}`,children:l(`absences.types.${m.absence_type}`)}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-auto",children:[new Date(m.start_date+"T00:00:00").toLocaleDateString(void 0,{day:"numeric",month:"short"}),m.start_date!==m.end_date&&e.jsxs(e.Fragment,{children:[" â€“ ",new Date(m.end_date+"T00:00:00").toLocaleDateString(void 0,{day:"numeric",month:"short"})]})]})]},D)})})]},c))})}export{Ie as AbsencesPage};
