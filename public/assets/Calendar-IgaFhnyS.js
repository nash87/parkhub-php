import{ab as f,ac as u,ad as M,ae as w,af as W,u as Y,v as L,t as R,r as m,w as z,ag as B,ah as I,ai as P,j as e,m as k,y as d,O as U,D as q}from"./index-DJOVTTEG.js";import{s as A}from"./CaretLeft.es-sB_PbD5r.js";function D(a,n,r){const s=f(a,r?.in);if(isNaN(n))return u(a,NaN);if(!n)return s;const i=s.getDate(),o=u(a,s.getTime());o.setMonth(s.getMonth()+n+1,0);const l=o.getDate();return i>=l?o:(s.setFullYear(o.getFullYear(),o.getMonth(),i),s)}function y(a,n,r){const[s,i]=M(r?.in,a,n);return+w(s)==+w(i)}function G(a,n){const r=f(a,n?.in);return r.setDate(1),r.setHours(0,0,0,0),r}function J(a,n){const r=n?.weekStartsOn,s=f(a,n?.in),i=s.getDay(),o=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function K(a,n,r){const[s,i]=M(r?.in,a,n);return s.getFullYear()===i.getFullYear()&&s.getMonth()===i.getMonth()}function Q(a,n){return y(u(a,a),W(a))}function V(a,n,r){return D(a,-1,r)}const v={confirmed:"bg-emerald-500",active:"bg-emerald-500",pending:"bg-amber-500",cancelled:"bg-gray-400",completed:"bg-primary-500",autoreleased:"bg-red-400"};function ee(){const{t:a,i18n:n}=Y(),r=n.language?.startsWith("de")?L:R,[s,i]=m.useState([]),[o,l]=m.useState(new Date),[c,S]=m.useState(null);m.useEffect(()=>{E()},[o]);async function E(){const t=await z.getCalendarEvents();t.success&&t.data&&i(t.data)}const O=G(o),_=B(o),C=I(O,{weekStartsOn:1}),$=J(_,{weekStartsOn:1}),b=[];let g=C;for(;g<=$;)b.push(g),g=P(g,1);const p=t=>s.filter(x=>y(new Date(x.start),t)),N=c?p(c):[];return e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6 max-w-full",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:a("calendar.title")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>l(V(o)),className:"p-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsx(A,{weight:"bold",className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 min-w-[140px] text-center",children:d(o,"MMMM yyyy",{locale:r})}),e.jsx("button",{onClick:()=>l(D(o,1)),className:"p-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsx(U,{weight:"bold",className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 dark:border-gray-700",children:["Mo","Tu","We","Th","Fr","Sa","Su"].map(t=>e.jsx("div",{className:"p-2 text-center text-xs font-medium text-gray-500 dark:text-gray-400",children:a(`calendar.days.${t.toLowerCase()}`)},t))}),e.jsx("div",{className:"grid grid-cols-7",children:b.map((t,x)=>{const h=p(t),F=K(t,o),H=Q(t),T=c&&y(t,c);return e.jsxs("button",{onClick:()=>S(t),className:`min-h-[60px] sm:min-h-[80px] p-1 border-b border-r border-gray-100 dark:border-gray-800 text-left transition-colors
                  ${F?"":"opacity-30"}
                  ${T?"bg-primary-50 dark:bg-primary-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}
                `,children:[e.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 text-xs font-medium rounded-full
                  ${H?"bg-primary-600 text-white":"text-gray-700 dark:text-gray-300"}
                `,children:d(t,"d")}),e.jsxs("div",{className:"mt-0.5 space-y-0.5",children:[h.slice(0,3).map(j=>e.jsx("div",{className:`h-1.5 rounded-full ${v[j.status]||"bg-gray-300"}`},j.id)),h.length>3&&e.jsxs("span",{className:"text-[10px] text-gray-400",children:["+",h.length-3]})]})]},x)})})]}),c&&e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:d(c,"EEEE, d. MMMM",{locale:r})}),N.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("calendar.noBookings")}):e.jsx("div",{className:"space-y-2",children:N.map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:`w-2 h-8 rounded-full ${v[t.status]||"bg-gray-300"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:[t.title,t.is_recurring&&e.jsx(q,{weight:"bold",className:"inline w-3.5 h-3.5 ml-1 text-primary-500"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[d(new Date(t.start),"HH:mm")," - ",d(new Date(t.end),"HH:mm"),t.lot_name&&` Â· ${t.lot_name}`]})]})]},t.id))})]})]})}export{ee as CalendarPage};
